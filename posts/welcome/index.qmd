---
title: "Global Cheese Analysis: Fat Content and Characteristics"
author: "Shu Wang"
date: "2024-09-05"
format:
  html:
    toc: true
    toc-depth: 2
---

## Executive Summary

This blog explores data sourced from Cheese.com to analyze how fat content, texture, flavor, and aroma vary among cheeses from different countries. The analysis reveals that European cheeses, such as those from France, Germany, and the United Kingdom, tend to have higher fat content, contributing to their rich textures and aromas. These insights provide useful information for cheese producers aiming to optimize their products based on consumer preferences in various markets.

## Problem Description

Cheese is a globally popular food, known for its diversity in flavor, texture, and nutritional composition. This analysis focuses on how the fat content of cheese varies by country, and how this affects characteristics like texture and flavor. Understanding these patterns can help cheese producers tailor their products to consumer tastes in different regions.

## Data Description

We utilized data from Cheese.com, which includes information on the fat content, texture, flavor, and aroma of cheeses from various countries. The dataset consists of several variables that describe cheese properties such as fat content, country of origin, and type of milk used.

```{r data-loading, echo=TRUE}
# Load the cheese data from GitHub
cheeses <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2024/2024-06-04/cheeses.csv')

# Display the first few rows of the dataset
head(cheeses)
```

## Data Cleaning and Preparation

The data contains some missing values and non-numeric fat content entries. We clean the dataset by filtering out cheeses with missing fat content and converting the fat content to numeric values where applicable.

```{r data-cleaning, echo=TRUE,warning=FALSE}
# Load necessary libraries
library(tidyverse)
library(stringr)

# Clean the cheese data
cheese_data_clean <- cheeses %>%
  filter(!is.na(fat_content)) %>%
  mutate(
    fat_content = as.numeric(str_extract(fat_content, "\\d+")),
    country = ifelse(is.na(country), "Unknown", country)
  )

# Display cleaned data
head(cheese_data_clean)
```

## Analysis

### Fat Content by Country

We first calculate the average fat content of cheeses by country to explore how fat content varies geographically. This provides insights into regional cheese-making practices.

```{r data-analysis-country, echo=TRUE}
# Calculate average fat content by country
avg_fat_by_country <- cheese_data_clean %>%
  group_by(country) %>%
  summarize(avg_fat_content = mean(fat_content, na.rm = TRUE)) %>%
  arrange(desc(avg_fat_content))

# Display the top 10 countries with the highest average fat content
knitr::kable(head(avg_fat_by_country, 10), col.names = c("Country", "Average Fat Content (%)"))
```

### Visualization: Average Fat Content by Country

We visualize the average fat content of cheeses by country in a bar chart to highlight the differences across regions.

```{r plot-results-country, fig.cap="Figure 1: Average Fat Content of Cheeses by Country", echo=FALSE}
# Plot average fat content by country
ggplot(avg_fat_by_country, aes(x = reorder(country, avg_fat_content), y = avg_fat_content)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  coord_flip() +
  labs(title = "Average Fat Content of Cheeses by Country", x = "Country", y = "Average Fat Content (%)") +
  theme_minimal()
```

### Fat Content by Texture

We now examine the relationship between cheese texture and fat content by calculating the average fat content for different cheese textures. This analysis helps to understand whether certain textures are associated with higher or lower fat levels.

```{r data-analysis-texture, echo=TRUE}
# Calculate average fat content by texture
avg_fat_by_texture <- cheese_data_clean %>%
  filter(!is.na(texture)) %>%
  group_by(texture) %>%
  summarize(avg_fat_content = mean(fat_content, na.rm = TRUE)) %>%
  arrange(desc(avg_fat_content))

# Display the top 10 textures with the highest average fat content
knitr::kable(head(avg_fat_by_texture, 10), col.names = c("Texture", "Average Fat Content (%)"))
```

### Fat Content by Texture

We plot the average fat content by texture, limiting the chart to the top 10 textures for clarity. We also wrap long texture names and rotate the x-axis labels to improve readability.

```{r plot-results-texture, fig.cap="Figure 2: Average Fat Content of Cheeses by Texture", echo=FALSE}
# Clean the texture data for display
avg_fat_by_texture <- avg_fat_by_texture %>%
  mutate(texture = stringr::str_wrap(texture, width = 15))

# Plot average fat content by texture
ggplot(avg_fat_by_texture %>% top_n(10, avg_fat_content), aes(x = reorder(texture, avg_fat_content), y = avg_fat_content)) +
  geom_bar(stat = "identity", fill = "lightgreen") +
  coord_flip() +
  labs(title = "Top 10 Average Fat Content of Cheeses by Texture", x = "Texture", y = "Average Fat Content (%)") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

## Key Results

-   **Fat Content by Country**: European countries like France, Germany, and the United Kingdom have the highest average fat content in their cheeses. This reflects traditional cheese-making practices that emphasize richness and creaminess.
-   **Fat Content by Texture**: Cheeses with creamier textures, such as "Creamy" and "Soft," tend to have higher fat content, while firmer cheeses exhibit lower fat levels.

## Conclusion

This analysis revealed important relationships between cheese fat content, texture, and country of origin. European cheeses, particularly from France and Germany, are characterized by higher fat content, which contributes to their rich textures. These insights can guide cheese producers in refining their products to better meet consumer demands in different regions, with specific attention to texture and fat content.

## References

-   Cheese.com (2024). *Global Cheese Information*. Retrieved from [Cheese.com](https://www.cheese.com/).
-   TidyTuesday (2024). *Cheese Dataset*. Retrieved from [GitHub](https://github.com/rfordatascience/tidytuesday/tree/master/data/2024/2024-06-04).


